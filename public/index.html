<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <script id="vs" type="x-shader/x-vertex">

        uniform mat4 modelMatrix;
        uniform mat4 viewMatrix;
        uniform mat4 projectionMatrix;
        uniform mat4 modelViewProjectionMatrix;

        attribute vec4 position;
        attribute vec3 normal;
        attribute vec2 texcoord;

        varying vec3 vNormal;
        varying vec3 vFragPosition;
        varying vec2 vTexcoord;
        
        void main() {
          vNormal = mat3(modelMatrix) * normal;
          vFragPosition = vec3(modelMatrix * position);
          vTexcoord = texcoord;
          gl_Position =  modelViewProjectionMatrix * position;
        }
          
    </script>
    <script id="fs" type="x-shader/x-fragment">

        #define PI 3.1415926535897932384626433832795
        #define MAX_MARCHING_STEPS 100

        #ifdef GL_ES
        // precision highp float;
        precision mediump float;
        #endif

        uniform sampler2D code;
        varying vec3 vNormal;
        varying vec3 vFragPosition;
        varying vec2 vTexcoord;

        float pixel2float(vec4 pixel) {
            float rByte = pixel.r * 255.0;
            float gByte = pixel.g * 255.0;
            float bByte = pixel.b * 255.0;
            float aByte = pixel.a * 255.0;

            float s = -step(127.0, aByte);
            float eLastBit = step(127.0, bByte);
            float e = (aByte + s * 128.0) * 2.0 + eLastBit;
            float m = (bByte - eLastBit * 128.0) * 65536.0 + gByte * 256.0 + rByte;
            float f = (s * 2.0 + 1.0) * (1.0 + m / 8388608.0) * pow(2.0, e - 127.0);
            return f;
        }

        vec4 run(sampler2D code) {
            vec4 color = vec4(0.0, 0.0, 0.0, 1.0);
            vec4 pixel = texture2D(code, vTexcoord);
            float x = pixel2float(pixel);
            if(x == 5.5)
                color = vec4(1.0, 0.0, 0.0, 1.0);
            return pixel;
        }

        void main() {
            gl_FragColor = run(code);
        }
          
    </script>
    <canvas id="c"></canvas>
</body>

</html>